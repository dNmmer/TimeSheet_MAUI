<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:TimeSheet_MAUI.ViewModels"
             x:Class="TimeSheet_MAUI.MainPage"
             x:DataType="vm:MainViewModel">

    <ContentPage.MenuBarItems>
        <MenuBarItem Text="Файл">
            <MenuFlyoutItem Text="Выбрать файл Excel"
                            Command="{Binding BrowseFileCommand}" />
            <MenuFlyoutItem Text="Создать шаблон"
                            Command="{Binding CreateTemplateCommand}" />
            <MenuFlyoutItem Text="Открыть текущий файл"
                            Command="{Binding OpenCurrentFileCommand}" />
            <MenuFlyoutItem Text="Обновить"
                            Command="{Binding ReloadReferenceCommand}" />
        </MenuBarItem>
        <MenuBarItem Text="Помощь">
            <MenuFlyoutItem Text="Требования"
                            Command="{Binding ShowRequirementsCommand}" />
            <MenuFlyoutItem Text="О приложении"
                            Command="{Binding ShowAboutCommand}" />
        </MenuBarItem>
    </ContentPage.MenuBarItems>

    <Grid RowDefinitions="*,Auto">
        <ScrollView Grid.Row="0">
            <VerticalStackLayout Spacing="12" Padding="16,8">
                <VerticalStackLayout Spacing="6">
                    <Label Text="Рабочий день"
                           FontSize="16"
                           FontAttributes="Bold"
                           FontFamily="OpenSansSemibold" />
                    <HorizontalStackLayout Spacing="10">
                        <Button Text="Начать"
                                FontSize="12"
                                FontFamily="OpenSansRegular"
                                Command="{Binding StartWorkdayCommand}"
                                IsEnabled="{Binding IsStartWorkdayEnabled}" />
                        <Button Text="Завершить"
                                FontSize="12"
                                FontFamily="OpenSansRegular"
                                Command="{Binding EndWorkdayCommand}"
                                IsEnabled="{Binding IsEndWorkdayEnabled}" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>

                <VerticalStackLayout Spacing="6">
                    <Label Text="Проект"
                           FontSize="14"
                           FontAttributes="Bold"
                           FontFamily="OpenSansSemibold" />
                    <Picker ItemsSource="{Binding Projects}"
                            SelectedItem="{Binding SelectedProject}"
                            FontSize="12"
                            FontFamily="OpenSansRegular"
                            IsEnabled="{Binding AreInputsEnabled}" />
                </VerticalStackLayout>

                <VerticalStackLayout Spacing="6">
                    <Label Text="Тип работ"
                           FontSize="14"
                           FontAttributes="Bold"
                           FontFamily="OpenSansSemibold" />
                    <Picker ItemsSource="{Binding WorkTypes}"
                            SelectedItem="{Binding SelectedWorkType}"
                            FontSize="12"
                            FontFamily="OpenSansRegular"
                            IsEnabled="{Binding AreInputsEnabled}" />
                </VerticalStackLayout>

                <VerticalStackLayout Spacing="12" HorizontalOptions="Center">
                    <Label Text="{Binding TimerText}"
                           FontSize="42"
                           FontAttributes="Bold"
                           FontFamily="OpenSansSemibold"
                           HorizontalTextAlignment="Center" />
                    <HorizontalStackLayout Spacing="18">
                        <ImageButton Source="icon_play_circle_48dp.png"
                                     Command="{Binding StartTimerCommand}"
                                     IsEnabled="{Binding AreInputsEnabled}"
                                     WidthRequest="44"
                                     HeightRequest="44"
                                     BackgroundColor="Transparent"
                                     Padding="8"
                                     SemanticProperties.Description="Старт" />
                        <ImageButton Source="icon_pause_circle_48dp.png"
                                     Command="{Binding PauseTimerCommand}"
                                     WidthRequest="48"
                                     HeightRequest="48"
                                     BackgroundColor="Transparent"
                                     Padding="8"
                                     SemanticProperties.Description="Пауза" />
                        <ImageButton Source="icon_stop_circle_48dp.png"
                                     Command="{Binding StopTimerCommand}"
                                     WidthRequest="48"
                                     HeightRequest="48"
                                     BackgroundColor="Transparent"
                                     Padding="8"
                                     SemanticProperties.Description="Стоп" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>

                <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" />
            </VerticalStackLayout>
        </ScrollView>

        <Border Grid.Row="1"
                BackgroundColor="Transparent"
                Padding="12,6"
                StrokeThickness="0"
                IsVisible="{Binding IsStatusOpen}">
            <Label Text="{Binding StatusMessage}"
                   VerticalOptions="Center"
                   FontSize="12"
                   FontFamily="OpenSansRegular"
                   TextColor="{AppThemeBinding Light=Black, Dark=White}" />
        </Border>
    </Grid>

</ContentPage>
